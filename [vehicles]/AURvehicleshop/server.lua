centreOfMassVeh = {
	[447] = 1.1000000238419,
	[448] = 0.67021918296814,
	[450] = 1.680503487587,
	[451] = 0.73247653245926,
	[452] = 0.58204936981201,
	[453] = 0.93193912506104,
	[454] = 1.2658512592316,
	[455] = 1.7699999809265,
	[456] = 1.25,
	[457] = 0.7293484210968,
	[458] = 0.94400000572205,
	[459] = 1.1399999856949,
	[460] = 2.219527721405,
	[461] = 0.67450171709061,
	[462] = 0.67021918296814,
	[463] = 1.2142517566681,
	[464] = 0.40700000524521,
	[465] = 0.33616995811462,
	[466] = 0.91999995708466,
	[467] = 0.87000000476837,
	[468] = 1.1141387224197,
	[469] = 1.1000000238419,
	[470] = 1.1100116968155,
	[471] = 0.57500004768372,
	[472] = 0.77418208122253,
	[473] = 0.32354342937469,
	[474] = 0.8999999165535,
	[475] = 0.8999999165535,
	[476] = 2.1701526641846,
	[477] = 0.85000002384186,
	[478] = 1.0799999237061,
	[479] = 0.8444310426712,
	[480] = 0.85000002384186,
	[481] = 0.60877597332001,
	[482] = 1.25,
	[483] = 1.0955964326859,
	[484] = 1.3414800167084,
	[485] = 0.70000004768372,
	[486] = 1.3000000715256,
	[487] = 1.2650001049042,
	[488] = 1.2650001049042,
	[489] = 1.3601264953613,
	[490] = 1.3201265335083,
	[491] = 0.89999997615814,
	[492] = 0.89999997615814,
	[493] = 1.3853187561035,
	[494] = 0.97000002861023,
	[495] = 1.5600740909576,
	[496] = 0.78772729635239,
	[497] = 1.2650001049042,
	[498] = 1.210000038147,
	[499] = 1.1802119016647,
	[500] = 1.0916599035263,
	[501] = 0.25301140546799,
	[502] = 0.96949034929276,
	[503] = 0.91999989748001,
	[504] = 0.93999999761581,
	[505] = 1.361983537674,
	[506] = 0.79211330413818,
	[507] = 0.95000004768372,
	[508] = 1.4499998092651,
	[509] = 0.61884170770645,
	[510] = 0.69584167003632,
	[511] = 2.5158975124359,
	[512] = 1.6339999437332,
	[513] = 1.78475689888,
	[514] = 1.6996749639511,
	[515] = 2.1537208557129,
	[516] = 0.72997510433197,
	[517] = 0.93566590547562,
	[518] = 0.79480773210526,
	[519] = 2.0000722408295,
	[520] = 1.9195756912231,
	[521] = 0.66037744283676,
	[522] = 0.66037744283676,
	[523] = 0.66037744283676,
	[524] = 2.0531990528107,
	[525] = 0.99000000953674,
	[526] = 0.84999984502792,
	[527] = 0.78314852714539,
	[528] = 1.1850000619888,
	[529] = 0.73788857460022,
	[530] = 0.80008590221405,
	[531] = 1.0064532756805,
	[532] = 2.1097192764282,
	[533] = 0.4335760474205,
	[534] = 0.82287710905075,
	[535] = 0.83999997377396,
	[536] = 0.85000014305115,
	[539] = 0.64999997615814,
	[540] = 0.97950112819672,
	[541] = 0.69999998807907,
	[542] = 0.84339815378189,
	[543] = 0.94999998807907,
	[544] = 1.3700000047684,
	[545] = 0.94999980926514,
	[546] = 0.84184813499451,
	[547] = 0.83999997377396,
	[548] = 2.9000618457794,
	[549] = 0.86147677898407,
	[550] = 0.92278164625168,
	[551] = 0.87999987602234,
	[552] = 0.77690815925598,
	[553] = 3.2349998950958,
	[554] = 1.1949999332428,
	[555] = 0.78037410974503,
	[556] = 0.3917441368103,
	[557] = 1.148087143898,
	[558] = 0.70379173755646,
	[559] = 0.75406360626221,
	[560] = 0.80497509241104,
	[561] = 0.92400002479553,
	[562] = 0.75354951620102,
	[563] = 1.8857496976852,
	[564] = 0.28516262769699,
	[565] = 0.6919310092926,
	[566] = 0.90000015497208,
	[567] = 0.97834157943726,
	[568] = 0.97500002384186,
	[571] = 0.33228185772896,
	[572] = 0.64000004529953,
	[573] = 1.215448141098,
	[574] = 0.79393339157104,
	[575] = 0.74000000953674,
	[576] = 0.75,
	[577] = 1.0746998786926,
	[578] = 1.7093948125839,
	[579] = 1.0979999303818,
	[580] = 0.90752363204956,
	[581] = 0.69976079463959,
	[582] = 1.1549999713898,
	[583] = 0.64689421653748,
	[584] = 2.1593854427338,
	[585] = 0.81999975442886,
	[586] = 0.5982506275177,
	[587] = 0.81000000238419,
	[588] = 1.1393926143646,
	[589] = 0.6952800154686,
	[591] = 1.6483741998672,
	[592] = 2.2973258495331,
	[593] = 1.5501824617386,
	[594] = 0.24500000476837,
	[595] = 1.102756023407,
	[596] = 0.81999969482422,
	[597] = 0.77497506141663,
	[598] = 0.86999970674515,
	[599] = 1.3851264715195,
	[600] = 0.84184813499451,
	[601] = 0.93020874261856,
	[602] = 0.90000009536743,
	[603] = 1.0026750564575,
	[604] = 0.62000346183777,
	[605] = 1.1981155872345,
	[606] = 1.0937063694,
	[607] = 1.1000000238419,
	[608] = 1.5730134248734,
	[609] = 1.210000038147,
	[610] = 0.4003584086895,
	[611] = 0.69189041852951,
}

addEvent ( "vehShop_spawnBuyedVehicle", true ) -- rip english

local antiSpam = {}
local proTiming = {}
function spawnTheVehicle (ID,price,licensePlate,x,y,z,rot,r1,g1,b1,r2,g2,b2)
	local maxSlots = exports.CSGplayervehicles:getPlayerVehicleSlots( source )
	if getPlayerMoney ( source ) >= tonumber(price) and tonumber(ID) then
		if ( not exports.server:getPlayerVehicles ( source ) or #exports.server:getPlayerVehicles ( source ) < maxSlots ) then
			triggerClientEvent ( source, "onClientExitCarshop", source )
			if isTimer(proTiming[source]) then
				exports.NGCdxmsg:createNewDxMessage(source,"Please dont spam vehicle buy function",255,0,0)
			return false end
			proTiming[source] = setTimer(function() end,10000,1)
			triggerClientEvent ( source, "onClientExitCarshop", source )
			local playerX, playerY, playerZ = getElementPosition(source)
			local color1 = exports.server:convertRGBToHEX( r1, g1, b1 )
			local color2 = exports.server:convertRGBToHEX( r2, g2, b2 )
			local ownerID = exports.server:getPlayerAccountID(source)
			removePedJetPack( source )
			setElementFrozen(source,false)
			local licenseLength = #licensePlate
			if #string.gsub(licensePlate," ","") >= 1 then
				local withoutNumbers,_ = string.gsub(licensePlate,"%d","")
				if #withoutNumbers < 1 then
					if licenseLength < 7 then
						licensePlate = "A"..licensePlate
					else
						licensePlate = string.sub(licensePlate,0,6).."A"
					end
				end
			else
				licensePlate = " AUR "
			end

			local playerVeh = exports.CSGplayervehicles:createPlayerVehicle ( source, ID, ownerID, 1000, price, color1, color2, x,y,z + ((centreOfMassVeh[id] or 0.5) * 2),rot, licensePlate )
			if isElement(playerVeh) then
				setVehicleDamageProof( playerVeh, true )
				setElementFrozen(playerVeh,true)
				setTimer ( function(vehicle)if isElement(vehicle) then setVehicleDamageProof( vehicle, false ) end end, 5000, 1, playerVeh )
				setTimer ( function(vehicle)if isElement(vehicle) then setElementFrozen( vehicle, false ) end end, 5000, 1, playerVeh )
				exports.NGCdxmsg:createNewDxMessage(source, "Your vehicle is being prepared.", 0, 255, 0 )
			else
				exports.NGCdxmsg:createNewDxMessage(source,"Vehicle wasn't spawned , please reconnect or try again",255,0,0)
			end
			triggerClientEvent ( source, "onClientExitCarshop", source )
		else
			exports.NGCdxmsg:createNewDxMessage(source, "You can only have "..tostring(maxSlots).." vehicles!", 255, 0, 0)
			--exports.NGCdxmsg:createNewDxMessage(source, "Sell one or upgrade your amount of max slots.", 255, 0, 0)
		end
	else
		exports.NGCdxmsg:createNewDxMessage(source, "You need at least $" .. tostring(price) .. " to buy this vehicle.", 255, 0, 0)
	end
end

addEventHandler ( "vehShop_spawnBuyedVehicle", root, spawnTheVehicle )


addEvent("onClientPlayerBuyCar",true)
addEventHandler("onClientPlayerBuyCar",root,function(id,price,plate,x,y,z,rot,r1,g1,b1,r2,g2,b2)
	if getElementDimension(source) ~= 0 then
		exports.NGCdxmsg:createNewDxMessage(source,"You can't enter while you are not in first dimension",255,0,0)
		return false
	elseif getElementInterior(source) ~= 0 then
		exports.NGCdxmsg:createNewDxMessage(source,"You can't enter while you are inside interior",255,0,0)
		return false
	elseif getElementData(source,"isPlayerArrested") then
		exports.NGCdxmsg:createNewDxMessage(source,"You can't enter while you are arrested",255,0,0)
		return false
	elseif getElementData(source,"isPlayerJailed") then
		exports.NGCdxmsg:createNewDxMessage(source,"You can't enter while you are Jailed",255,0,0)
		return false
	elseif getElementData(source,"isPlayerFlagger") then
		exports.NGCdxmsg:createNewDxMessage(source,"You can't enter while you are holding an armour",255,0,0)
		return false
	elseif exports.AURgames:isPlayerSigned(source) then
		exports.NGCdxmsg:createNewDxMessage(source,"You can't enter while you are signed up in mini games",255,0,0)
		return false
	end
	if isTimer(antiSpam[source]) then
		exports.NGCdxmsg:createNewDxMessage(source,"please wait few seconds to prevent spam",255,0,0)
		return false
	end
	antiSpam[source] = setTimer(function() end,10000,1)
	triggerEvent("vehShop_spawnBuyedVehicle",source,id,price,plate,x,y,z,rot,r1,g1,b1,r2,g2,b2)
end)


function handle()
	triggerClientEvent ( source, "onClientExitCarshop", source )
end
addEventHandler("onPlayerWasted",root,handle)
addEventHandler("onPlayerQuit",root,handle)
addEventHandler("onPlayerArrest",root,handle)
addEventHandler("onPlayerJailed",root,handle)
